<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part 9 Interaction networks, food webs, and complexity in ecology (Day 4) | Theory-driven analysis of ecological data: a practical handbook</title>
  <meta name="description" content="<p>This is a draft for our course on model-data.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Part 9 Interaction networks, food webs, and complexity in ecology (Day 4) | Theory-driven analysis of ecological data: a practical handbook" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a draft for our course on model-data.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part 9 Interaction networks, food webs, and complexity in ecology (Day 4) | Theory-driven analysis of ecological data: a practical handbook" />
  
  <meta name="twitter:description" content="<p>This is a draft for our course on model-data.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="us" />


<meta name="date" content="2024-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-data-day-3.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Theory-driven analysis of ecological data: a practical handbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About Bookdown</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#render-book"><i class="fa fa-check"></i><b>1.2</b> Render book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preview-book"><i class="fa fa-check"></i><b>1.3</b> Preview book</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#here-are-some-useful-things-for-writing-the-book-using-bookdown"><i class="fa fa-check"></i><b>1.4</b> Here are some useful things for writing the book using bookdown</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#a-section"><i class="fa fa-check"></i><b>1.4.1</b> A section</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#cross"><i class="fa fa-check"></i><b>1.5</b> Cross-references</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#chapters-and-sub-chapters"><i class="fa fa-check"></i><b>1.5.1</b> Chapters and sub-chapters</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#captioned-figures-and-tables"><i class="fa fa-check"></i><b>1.5.2</b> Captioned figures and tables</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#parts"><i class="fa fa-check"></i><b>1.6</b> Parts</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#footnotes-and-citations"><i class="fa fa-check"></i><b>1.7</b> Footnotes and citations</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#footnotes"><i class="fa fa-check"></i><b>1.7.1</b> Footnotes</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#citations"><i class="fa fa-check"></i><b>1.7.2</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#blocks"><i class="fa fa-check"></i><b>1.8</b> Blocks</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#equations"><i class="fa fa-check"></i><b>1.8.1</b> Equations</a></li>
<li class="chapter" data-level="1.8.2" data-path="index.html"><a href="index.html#theorems-and-proofs"><i class="fa fa-check"></i><b>1.8.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="1.8.3" data-path="index.html"><a href="index.html#callout-blocks"><i class="fa fa-check"></i><b>1.8.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#sharing-your-book"><i class="fa fa-check"></i><b>1.9</b> Sharing your book</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="index.html"><a href="index.html#publishing"><i class="fa fa-check"></i><b>1.9.1</b> Publishing</a></li>
<li class="chapter" data-level="1.9.2" data-path="index.html"><a href="index.html#pages"><i class="fa fa-check"></i><b>1.9.2</b> 404 pages</a></li>
<li class="chapter" data-level="1.9.3" data-path="index.html"><a href="index.html#metadata-for-sharing"><i class="fa fa-check"></i><b>1.9.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="preambule.html"><a href="preambule.html"><i class="fa fa-check"></i><b>2</b> Preambule</a></li>
<li class="chapter" data-level="3" data-path="why-mathematical-models-sonia.html"><a href="why-mathematical-models-sonia.html"><i class="fa fa-check"></i><b>3</b> Why mathematical models? (Sonia)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="why-mathematical-models-sonia.html"><a href="why-mathematical-models-sonia.html#big-data"><i class="fa fa-check"></i><b>3.1</b> Big data</a></li>
<li class="chapter" data-level="3.2" data-path="why-mathematical-models-sonia.html"><a href="why-mathematical-models-sonia.html#what-is-theory"><i class="fa fa-check"></i><b>3.2</b> What is theory?</a></li>
<li class="chapter" data-level="3.3" data-path="why-mathematical-models-sonia.html"><a href="why-mathematical-models-sonia.html#whats-a-model"><i class="fa fa-check"></i><b>3.3</b> What’s a model?</a></li>
<li class="chapter" data-level="3.4" data-path="why-mathematical-models-sonia.html"><a href="why-mathematical-models-sonia.html#purpose-of-science"><i class="fa fa-check"></i><b>3.4</b> Purpose of science?</a></li>
<li class="chapter" data-level="3.5" data-path="why-mathematical-models-sonia.html"><a href="why-mathematical-models-sonia.html#can-we-do-that-with-big-data-analysis"><i class="fa fa-check"></i><b>3.5</b> Can we do that with big data analysis?</a></li>
<li class="chapter" data-level="3.6" data-path="why-mathematical-models-sonia.html"><a href="why-mathematical-models-sonia.html#the-scientific-method"><i class="fa fa-check"></i><b>3.6</b> The scientific method</a></li>
<li class="chapter" data-level="3.7" data-path="why-mathematical-models-sonia.html"><a href="why-mathematical-models-sonia.html#a-feedback-loop-involving-data-and-models"><i class="fa fa-check"></i><b>3.7</b> A feedback loop involving data and models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-types-of-theoretical-models-in-ecology-isa.html"><a href="what-types-of-theoretical-models-in-ecology-isa.html"><i class="fa fa-check"></i><b>4</b> What types of theoretical models in ecology? (Isa)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="what-types-of-theoretical-models-in-ecology-isa.html"><a href="what-types-of-theoretical-models-in-ecology-isa.html#what-system-what-question-what-hypotheses-no-maths-shown-here"><i class="fa fa-check"></i><b>4.1</b> What system? What question? What hypotheses (no maths shown here)</a></li>
<li class="chapter" data-level="4.2" data-path="what-types-of-theoretical-models-in-ecology-isa.html"><a href="what-types-of-theoretical-models-in-ecology-isa.html#what-model-formalism-no-maths-shown-here"><i class="fa fa-check"></i><b>4.2</b> What model formalism? (no maths shown here)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="what-types-of-theoretical-models-in-ecology-isa.html"><a href="what-types-of-theoretical-models-in-ecology-isa.html#deterministic-stochastic-processes"><i class="fa fa-check"></i><b>4.2.1</b> Deterministic – stochastic processes</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-types-of-theoretical-models-in-ecology-isa.html"><a href="what-types-of-theoretical-models-in-ecology-isa.html#time-discrete-continuous"><i class="fa fa-check"></i><b>4.2.2</b> Time: discrete – continuous</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-types-of-theoretical-models-in-ecology-isa.html"><a href="what-types-of-theoretical-models-in-ecology-isa.html#accounting-for-space"><i class="fa fa-check"></i><b>4.2.3</b> Accounting for space</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-types-of-theoretical-models-in-ecology-isa.html"><a href="what-types-of-theoretical-models-in-ecology-isa.html#what-technical-choices"><i class="fa fa-check"></i><b>4.3</b> What technical choices?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="what-types-of-theoretical-models-in-ecology-isa.html"><a href="what-types-of-theoretical-models-in-ecology-isa.html#analytical-numerical"><i class="fa fa-check"></i><b>4.3.1</b> Analytical – Numerical</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-types-of-theoretical-models-in-ecology-isa.html"><a href="what-types-of-theoretical-models-in-ecology-isa.html#rules-versus-maths"><i class="fa fa-check"></i><b>4.3.2</b> Rules versus Maths</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-types-of-theoretical-models-in-ecology-isa.html"><a href="what-types-of-theoretical-models-in-ecology-isa.html#some-classical-models-used-in-ecology-and-seen-next-days"><i class="fa fa-check"></i><b>4.4</b> Some classical models used in ecology and seen next days</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="how-to-build-a-model-isa.html"><a href="how-to-build-a-model-isa.html"><i class="fa fa-check"></i><b>5</b> How to build a model? (Isa)</a></li>
<li class="chapter" data-level="6" data-path="how-to-analyze-a-model-isa.html"><a href="how-to-analyze-a-model-isa.html"><i class="fa fa-check"></i><b>6</b> How to analyze a model? (Isa)</a></li>
<li class="chapter" data-level="7" data-path="temporal-data-day-2.html"><a href="temporal-data-day-2.html"><i class="fa fa-check"></i><b>7</b> Temporal data (Day 2)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="temporal-data-day-2.html"><a href="temporal-data-day-2.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="temporal-data-day-2.html"><a href="temporal-data-day-2.html#conclusion"><i class="fa fa-check"></i><b>7.2</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-data-day-3.html"><a href="spatial-data-day-3.html"><i class="fa fa-check"></i><b>8</b> Spatial data (Day 3)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-data-day-3.html"><a href="spatial-data-day-3.html#introduction-1"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="spatial-data-day-3.html"><a href="spatial-data-day-3.html#theoretical-frameworks-toattack-these-issues"><i class="fa fa-check"></i><b>8.2</b> Theoretical frameworks toattack these issues</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-data-day-3.html"><a href="spatial-data-day-3.html#data-driven-statistical-approaches"><i class="fa fa-check"></i><b>8.3</b> DATA-DRIVEN (STATISTICAL) APPROACHES</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-data-day-3.html"><a href="spatial-data-day-3.html#community-level-methods"><i class="fa fa-check"></i><b>8.3.1</b> Community level methods</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="spatial-data-day-3.html"><a href="spatial-data-day-3.html#process-driven-mechanistic-approaches"><i class="fa fa-check"></i><b>8.4</b> PROCESS-DRIVEN (MECHANISTIC) APPROACHES</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="spatial-data-day-3.html"><a href="spatial-data-day-3.html#patch-occupancy-models"><i class="fa fa-check"></i><b>8.4.1</b> Patch-occupancy models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="spatial-data-day-3.html"><a href="spatial-data-day-3.html#conclusion-1"><i class="fa fa-check"></i><b>8.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><i class="fa fa-check"></i><b>9</b> Interaction networks, food webs, and complexity in ecology (Day 4)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#preamble-of-the-script-used-during-the-course"><i class="fa fa-check"></i><b>9.1</b> Preamble of the script used during the course</a></li>
<li class="chapter" data-level="9.2" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#networks-and-associated-definitions"><i class="fa fa-check"></i><b>9.2</b> Networks and associated definitions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#what-is-a-network"><i class="fa fa-check"></i><b>9.2.1</b> What is a network?</a></li>
<li class="chapter" data-level="9.2.2" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#networks-in-ecology"><i class="fa fa-check"></i><b>9.2.2</b> Networks in ecology</a></li>
<li class="chapter" data-level="9.2.3" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#ecological-interaction-networks"><i class="fa fa-check"></i><b>9.2.3</b> Ecological interaction networks</a></li>
<li class="chapter" data-level="9.2.4" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#a-little-history"><i class="fa fa-check"></i><b>9.2.4</b> A little history</a></li>
<li class="chapter" data-level="9.2.5" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#types-of-network"><i class="fa fa-check"></i><b>9.2.5</b> Types of network</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#representation-of-networks"><i class="fa fa-check"></i><b>9.3</b> Representation of networks</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#binary-networks"><i class="fa fa-check"></i><b>9.3.1</b> Binary networks</a></li>
<li class="chapter" data-level="9.3.2" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#weighted-networks"><i class="fa fa-check"></i><b>9.3.2</b> Weighted networks</a></li>
<li class="chapter" data-level="9.3.3" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#network-matrices"><i class="fa fa-check"></i><b>9.3.3</b> Network matrices</a></li>
<li class="chapter" data-level="9.3.4" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#matrices-for-multipartite-networks"><i class="fa fa-check"></i><b>9.3.4</b> Matrices for multipartite networks</a></li>
<li class="chapter" data-level="9.3.5" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#degrees"><i class="fa fa-check"></i><b>9.3.5</b> Degrees</a></li>
<li class="chapter" data-level="9.3.6" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#connectance"><i class="fa fa-check"></i><b>9.3.6</b> Connectance</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#crash-course-matrices-eigenvalues-jacobian-matrix"><i class="fa fa-check"></i><b>9.4</b> Crash course: matrices, eigenvalues, Jacobian matrix</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#crash-course-matrices"><i class="fa fa-check"></i><b>9.4.1</b> Crash course: matrices</a></li>
<li class="chapter" data-level="9.4.2" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#crash-course-matrix-eigenvalues"><i class="fa fa-check"></i><b>9.4.2</b> Crash course: matrix eigenvalues</a></li>
<li class="chapter" data-level="9.4.3" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#crash-course-jacobian-matrices"><i class="fa fa-check"></i><b>9.4.3</b> Crash course: Jacobian matrices</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#theories-and-notable-results"><i class="fa fa-check"></i><b>9.5</b> Theories and notable results</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#lotka-volterra-and-networks"><i class="fa fa-check"></i><b>9.5.1</b> Lotka-Volterra and networks</a></li>
<li class="chapter" data-level="9.5.2" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#mays-stability-result"><i class="fa fa-check"></i><b>9.5.2</b> May’s stability result</a></li>
<li class="chapter" data-level="9.5.3" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#feasibility-vs.-stability"><i class="fa fa-check"></i><b>9.5.3</b> Feasibility vs. stability</a></li>
<li class="chapter" data-level="9.5.4" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#food-web-invariants"><i class="fa fa-check"></i><b>9.5.4</b> Food web invariants</a></li>
<li class="chapter" data-level="9.5.5" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#generating-the-niche-model"><i class="fa fa-check"></i><b>9.5.5</b> Generating the niche model</a></li>
<li class="chapter" data-level="9.5.6" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#robustness-to-secondary-extinctions"><i class="fa fa-check"></i><b>9.5.6</b> Robustness to secondary extinctions</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#a-quick-primer-on-network-statistics"><i class="fa fa-check"></i><b>9.6</b> A quick primer on network statistics</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#degree-distributions"><i class="fa fa-check"></i><b>9.6.1</b> Degree distributions</a></li>
<li class="chapter" data-level="9.6.2" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#null-models-randomizations"><i class="fa fa-check"></i><b>9.6.2</b> Null models / randomizations</a></li>
<li class="chapter" data-level="9.6.3" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#network-structure"><i class="fa fa-check"></i><b>9.6.3</b> Network structure</a></li>
<li class="chapter" data-level="9.6.4" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#modularity"><i class="fa fa-check"></i><b>9.6.4</b> Modularity</a></li>
<li class="chapter" data-level="9.6.5" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#block-models"><i class="fa fa-check"></i><b>9.6.5</b> Block models</a></li>
<li class="chapter" data-level="9.6.6" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#modularity-and-blocks"><i class="fa fa-check"></i><b>9.6.6</b> Modularity and blocks</a></li>
<li class="chapter" data-level="9.6.7" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#spectral-clustering"><i class="fa fa-check"></i><b>9.6.7</b> Spectral clustering</a></li>
<li class="chapter" data-level="9.6.8" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#nestedness"><i class="fa fa-check"></i><b>9.6.8</b> Nestedness</a></li>
<li class="chapter" data-level="9.6.9" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#last-words"><i class="fa fa-check"></i><b>9.6.9</b> Last words</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#literature"><i class="fa fa-check"></i><b>9.7</b> Literature</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Theory-driven analysis of ecological data: a practical handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interaction-networks-food-webs-and-complexity-in-ecology-day-4" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Part 9</span> Interaction networks, food webs, and complexity in ecology (Day 4)<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#interaction-networks-food-webs-and-complexity-in-ecology-day-4" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="preamble-of-the-script-used-during-the-course" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Preamble of the script used during the course<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#preamble-of-the-script-used-during-the-course" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb6-1" tabindex="-1"></a><span class="fu">library</span>(cheddar)</span>
<span id="cb6-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb6-2" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb10-1" tabindex="-1"></a><span class="fu">library</span>(vegan)</span></code></pre></div>
<pre><code>## Loading required package: permute</code></pre>
<pre><code>## 
## Attaching package: &#39;permute&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:igraph&#39;:
## 
##     permute</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## This is vegan 2.6-4</code></pre>
<pre><code>## 
## Attaching package: &#39;vegan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:igraph&#39;:
## 
##     diversity</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb18-1" tabindex="-1"></a><span class="fu">library</span>(sbm)</span>
<span id="cb18-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb18-2" tabindex="-1"></a><span class="fu">library</span>(alluvial)</span>
<span id="cb18-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb18-3" tabindex="-1"></a><span class="fu">library</span>(faux)</span></code></pre></div>
<pre><code>## 
## ************
## Welcome to faux. For support and examples visit:
## https://debruine.github.io/faux/
## - Get and set global package options with: faux_options()
## ************</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb20-1" tabindex="-1"></a><span class="fu">library</span>(devtools) </span></code></pre></div>
<pre><code>## Loading required package: usethis</code></pre>
<pre><code>## 
## Attaching package: &#39;devtools&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:permute&#39;:
## 
##     check</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb24-1" tabindex="-1"></a><span class="co">#Sys.unsetenv(&quot;GITHUB_PAT&quot;)</span></span>
<span id="cb24-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb24-2" tabindex="-1"></a><span class="co">#install_github(&quot;FMestre1/fw_package&quot;)</span></span>
<span id="cb24-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb24-3" tabindex="-1"></a><span class="fu">library</span>(FWebs)</span>
<span id="cb24-4"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb24-4" tabindex="-1"></a><span class="fu">library</span>(matlib)</span>
<span id="cb24-5"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb24-5" tabindex="-1"></a><span class="fu">library</span>(calculus)</span>
<span id="cb24-6"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb24-6" tabindex="-1"></a><span class="fu">library</span>(pracma)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;pracma&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:calculus&#39;:
## 
##     cross, gradient, hessian, integral, jacobian, laplacian, taylor</code></pre>
<pre><code>## The following objects are masked from &#39;package:matlib&#39;:
## 
##     angle, inv</code></pre>
<pre><code>## The following object is masked from &#39;package:vegan&#39;:
## 
##     procrustes</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb29-1" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;functions_network.R&#39;</span>)</span>
<span id="cb29-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb29-3" tabindex="-1"></a><span class="do">####In FWebs, there is a large list of food webs called mg1</span></span>
<span id="cb29-4"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb29-4" tabindex="-1"></a><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mg1[[<span class="dv">1</span>]]),<span class="cf">function</span>(x) <span class="fu">dim</span>(<span class="fu">as.matrix</span>(mg1[[<span class="dv">1</span>]][[x]]))[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>##   [1]  66  56  50  20  10  16  14  19  48  22  26  24  12  56  46  38  33  26
##  [19]  21  26  22  49  23  28  61  54  30  78  65  29  45  16  41  49  34  12
##  [37]  37  31  78  33  41  78  53  15  12  78  78  24  79 714  35  24  20  30
##  [55]  13  37  72  78  15  28  13  56  27  46  44  16  14  53  40  23  26  68
##  [73]  50  61  21  23  27  25  28  32  19  39  27  57  30  75  15  41  35  39
##  [91]  47  21  50  50 106  16  35  24  29  24  25  21  16  35   6  27  27  28
## [109]  27  26  52  24  25  26  27  28  13  24  24  44  69  81  39  70  55  18
## [127]  16  31  17  19  39  32  44  35  65  52  42  32  33  40  14  21  14  35
## [145]  25  33  26  25  14  39  51  29  24  15  14  27  21  31  41  18  59  49
## [163]  45  39  35  37  36  27   9  29  32  13  15   7   8   9  36  19  32  22
## [181]  23   6  20  29  42  57  72  36  31   9  47  89  12   9  12  12  19  24
## [199]  22  23   8  29  22  22  40  30   7  15  26  90  18   8  27  43  11  32
## [217]  37  42  45  38  42  37 106  16  35  24  16  36  37  13   9  12   9  12
## [235]  12  19  24  69  67  55  70  59  24 714  20  22  50  56  29  78  25  22
## [253]  26  61  48  35  65  78  78  39  10  13  32  31  12  69  57  78  78  16
## [271]  15  15  72  20  10  22  31  24  25  31  32  20  56  66  17  12  47  30
## [289]  46  18   8  16  29  50  42  32  31  30  28  56  50  14  25  49  51  75
## [307]  23  28  36  32  19  34  22  39  68  57  13  36  90   9   7   7   9  47
## [325]  89  26  34  23  17  14  43  50  61  53  72  35  31   8  13  27  81  53
## [343]  13  26  30  12  33  41  22  27  28  65  78  37  25  39  29  26  14  25
## [361]  24  21  15  29  19  27  22  49  30  41  35  44  31  37  22  24  44  42
## [379]   7  15  26  27  27  24  15   9  39  39  54  49</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb31-1" tabindex="-1"></a><span class="do">####Extract data from web 1,223</span></span>
<span id="cb31-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb31-2" tabindex="-1"></a>mat<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(mg1[[<span class="dv">1</span>]][[<span class="dv">223</span>]])</span>
<span id="cb31-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb31-3" tabindex="-1"></a><span class="fu">plotMyMatrix</span>(mat)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb32-1" tabindex="-1"></a>net.mat<span class="ot">&lt;-</span><span class="fu">graph_from_adjacency_matrix</span>(mat,<span class="at">mode=</span><span class="st">&quot;directed&quot;</span>)</span></code></pre></div>
<p>TO DO: change the way FWebs is used because it does not compile on Mac and Linux…</p>
</div>
<div id="networks-and-associated-definitions" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Networks and associated definitions<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#networks-and-associated-definitions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="what-is-a-network" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> What is a network?<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#what-is-a-network" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Networks (or graphs) are sets of nodes linked by edges.
Edges represent pairwise relationships between nodes.
Edges can be directed or not, weighted or binary (0/1).</p>
</div>
<div id="networks-in-ecology" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Networks in ecology<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#networks-in-ecology" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main types of networks that you can encounter in ecology:
- the most common: interaction networks (edges are interactions, nodes are species)
- less common: spatial networks (edges are spatial connections, nodes are populations on a map)
- the rarest: assembly networks (edges are transitions between community compositions, nodes are community compositions)</p>
</div>
<div id="ecological-interaction-networks" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Ecological interaction networks<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#ecological-interaction-networks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since biotic interactions are very diverse, many different types of interaction networks can be built (mutualistic, antagonistic, etc.).
The type of data that can be obtained on networks is manifold:
- interaction frequency, especially from field observations (e.g. how many times a pollinator species is observed on a particular plant species);
- co-abundances or co-occurrences of the species pairs;
- interaction potentials, mostly obtained from experiments (e.g. arena experiments in which species are put together pairwise to observe interactions)</p>
</div>
<div id="a-little-history" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> A little history<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#a-little-history" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The study of ecological interaction networks begun as early as the 50’s with some landmark papers like Hutchinson’s (Santa Rosalia, etc.) or Paine’s series of keystone predation papers. The book of Allee is remarkable as it contains some of the earliest diagrams of food webs.</p>
</div>
<div id="types-of-network" class="section level3 hasAnchor" number="9.2.5">
<h3><span class="header-section-number">9.2.5</span> Types of network<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#types-of-network" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="unipartite-networks" class="section level4 hasAnchor" number="9.2.5.1">
<h4><span class="header-section-number">9.2.5.1</span> Unipartite networks<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#unipartite-networks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>One large class of ecological networks is unipartite networks, i.e. messy ones in which interactions can occur between any two species. E.g. the Benguela food web of Yodzis (1998).
The function sample_gnp can generate random unipartite networks using the Erdos-Reyi model, which assumes that any interaction has the same probability to exist.
The plot function of igraph makes basic plots of networks, the layout option helps see things a wee bit more clearly.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb33-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">sample_gnp</span>(<span class="dv">30</span>,<span class="fl">0.2</span>,<span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb33-2" tabindex="-1"></a><span class="fu">plot</span>(net)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb34-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">sample_gnp</span>(<span class="dv">30</span>,<span class="fl">0.2</span>, <span class="at">directed =</span><span class="cn">TRUE</span>)</span>
<span id="cb34-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb34-2" tabindex="-1"></a><span class="fu">plot</span>(net)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb35-1" tabindex="-1"></a><span class="fu">plot</span>(net.mat,<span class="at">layout=</span>layout_with_mds)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb36-1" tabindex="-1"></a><span class="fu">plot</span>(net.mat,<span class="at">layout=</span>layout_as_tree)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-4.png" width="672" /></p>
</div>
<div id="multipartite-networks" class="section level4 hasAnchor" number="9.2.5.2">
<h4><span class="header-section-number">9.2.5.2</span> Multipartite networks<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#multipartite-networks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another large class of networks is the one consisting of multipartite networks, i.e. networks in which nodes can be partitioned among different levels and nodes only interact among different levels and never within the same level.
Each species/node then has a “role” which defines its “level”.
The most common type of multipartite network encountered in ecology is bipartite network (only two levels) such as plant-pollinator networks.
The function sample_bipartite generates a random bipartite network using the Erdos-Renyi model.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb37-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">sample_bipartite</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="st">&quot;gnp&quot;</span>,<span class="fl">0.1</span>)</span>
<span id="cb37-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb37-2" tabindex="-1"></a><span class="fu">plot</span>(net,<span class="at">layout=</span>layout_as_bipartite)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="representation-of-networks" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Representation of networks<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#representation-of-networks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="binary-networks" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Binary networks<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#binary-networks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Having networks as collections of nodes and edges can be insightful, but to make computations on networks, one needs to express them using useful mathematical object. The easiest way is to express a network as a matrix called the adjacency matrix. The element <span class="math inline">\(a_{ij}\)</span> of an adjacency matrix is equal to 1 iff there exists an interaction between species <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. This also works for directed networks.
The function sample_grg given here generates a random graph based on a random geometric graph process – it assumes that nodes have coordinates in 2D within a 1 x 1 square and interactions exist when the distance between two nodes is less than a given threshold (here, 0.2).
The function as_adjacency_matrix yields the adjacency matrix of the network.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb38-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">sample_grg</span>(<span class="dv">30</span>, <span class="fl">0.2</span>)</span>
<span id="cb38-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb38-2" tabindex="-1"></a><span class="fu">as_adjacency_matrix</span>(net)</span></code></pre></div>
<pre><code>## 30 x 30 sparse Matrix of class &quot;dgCMatrix&quot;
##                                                                  
##  [1,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##  [2,] . . 1 . 1 . . . . . . . . . . . . . . . . . . . . . . . . .
##  [3,] . 1 . . 1 . . . . . . . . . . . . . . . . . . . . . . . . .
##  [4,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##  [5,] . 1 1 . . . 1 . . . . . . . . . . . . . . . . . . . . . . .
##  [6,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##  [7,] . . . . 1 . . 1 1 1 1 1 . . . . . . . . . . . . . . . . . .
##  [8,] . . . . . . 1 . 1 . . . . . . . . . . . . . . . . . . . . .
##  [9,] . . . . . . 1 1 . 1 1 1 . . . . . . . . . . . . . . . . . .
## [10,] . . . . . . 1 . 1 . 1 1 . . . . . . . . . . . . . . . . . .
## [11,] . . . . . . 1 . 1 1 . 1 . . . . . . . . . . . . . . . . . .
## [12,] . . . . . . 1 . 1 1 1 . . 1 . . 1 . . . . . . . . . . . . .
## [13,] . . . . . . . . . . . . . . 1 . . . . . . . . . . . . . . .
## [14,] . . . . . . . . . . . 1 . . . . . 1 . . . . . . . . . . . .
## [15,] . . . . . . . . . . . . 1 . . 1 . . . . 1 1 . . . . . . . .
## [16,] . . . . . . . . . . . . . . 1 . . . . . 1 . . . . . . . . .
## [17,] . . . . . . . . . . . 1 . . . . . . 1 1 . . 1 . 1 . . . . .
## [18,] . . . . . . . . . . . . . 1 . . . . . . . . . . . . . . . .
## [19,] . . . . . . . . . . . . . . . . 1 . . 1 . . 1 . 1 . . . . .
## [20,] . . . . . . . . . . . . . . . . 1 . 1 . 1 . 1 . 1 . . . . .
## [21,] . . . . . . . . . . . . . . 1 1 . . . 1 . 1 . 1 . 1 . . . .
## [22,] . . . . . . . . . . . . . . 1 . . . . . 1 . . 1 . 1 . . . .
## [23,] . . . . . . . . . . . . . . . . 1 . 1 1 . . . . 1 . . . . .
## [24,] . . . . . . . . . . . . . . . . . . . . 1 1 . . . 1 . . . .
## [25,] . . . . . . . . . . . . . . . . 1 . 1 1 . . 1 . . . . . . .
## [26,] . . . . . . . . . . . . . . . . . . . . 1 1 . 1 . . . 1 1 .
## [27,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
## [28,] . . . . . . . . . . . . . . . . . . . . . . . . . 1 . . 1 .
## [29,] . . . . . . . . . . . . . . . . . . . . . . . . . 1 . 1 . .
## [30,] . . . . . . . . . . . . . . . . . . . . . . . . . . 1 . . .</code></pre>
</div>
<div id="weighted-networks" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Weighted networks<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#weighted-networks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When a network is weighted, the weighted adjacency matrix represents not only the existing/absent interactions, but also how strong these interactions are.
Here, we create random weights for the edges of network “net” using a Poisson distribution of mean 2.
Adding “[,]” after the name of network also yields the adjacency matrix.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb40-1" tabindex="-1"></a><span class="fu">E</span>(net)<span class="sc">$</span>weight<span class="ot">&lt;-</span><span class="fu">rpois</span>(<span class="fu">length</span>(<span class="fu">E</span>(net)),<span class="dv">2</span>)</span>
<span id="cb40-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb40-2" tabindex="-1"></a>net[,]</span></code></pre></div>
<pre><code>## 30 x 30 sparse Matrix of class &quot;dgCMatrix&quot;
##                                                                  
##  [1,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##  [2,] . . 0 . 3 . . . . . . . . . . . . . . . . . . . . . . . . .
##  [3,] . 0 . . 5 . . . . . . . . . . . . . . . . . . . . . . . . .
##  [4,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##  [5,] . 3 5 . . . 1 . . . . . . . . . . . . . . . . . . . . . . .
##  [6,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##  [7,] . . . . 1 . . 1 5 4 2 2 . . . . . . . . . . . . . . . . . .
##  [8,] . . . . . . 1 . 6 . . . . . . . . . . . . . . . . . . . . .
##  [9,] . . . . . . 5 6 . 3 2 4 . . . . . . . . . . . . . . . . . .
## [10,] . . . . . . 4 . 3 . 4 5 . . . . . . . . . . . . . . . . . .
## [11,] . . . . . . 2 . 2 4 . 2 . . . . . . . . . . . . . . . . . .
## [12,] . . . . . . 2 . 4 5 2 . . 1 . . 3 . . . . . . . . . . . . .
## [13,] . . . . . . . . . . . . . . 1 . . . . . . . . . . . . . . .
## [14,] . . . . . . . . . . . 1 . . . . . 2 . . . . . . . . . . . .
## [15,] . . . . . . . . . . . . 1 . . 6 . . . . 0 1 . . . . . . . .
## [16,] . . . . . . . . . . . . . . 6 . . . . . 4 . . . . . . . . .
## [17,] . . . . . . . . . . . 3 . . . . . . 2 5 . . 2 . 3 . . . . .
## [18,] . . . . . . . . . . . . . 2 . . . . . . . . . . . . . . . .
## [19,] . . . . . . . . . . . . . . . . 2 . . 5 . . 1 . 2 . . . . .
## [20,] . . . . . . . . . . . . . . . . 5 . 5 . 2 . 1 . 0 . . . . .
## [21,] . . . . . . . . . . . . . . 0 4 . . . 2 . 2 . 1 . 1 . . . .
## [22,] . . . . . . . . . . . . . . 1 . . . . . 2 . . 4 . 1 . . . .
## [23,] . . . . . . . . . . . . . . . . 2 . 1 1 . . . . 0 . . . . .
## [24,] . . . . . . . . . . . . . . . . . . . . 1 4 . . . 0 . . . .
## [25,] . . . . . . . . . . . . . . . . 3 . 2 0 . . 0 . . . . . . .
## [26,] . . . . . . . . . . . . . . . . . . . . 1 1 . 0 . . . 1 5 .
## [27,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 0
## [28,] . . . . . . . . . . . . . . . . . . . . . . . . . 1 . . 2 .
## [29,] . . . . . . . . . . . . . . . . . . . . . . . . . 5 . 2 . .
## [30,] . . . . . . . . . . . . . . . . . . . . . . . . . . 0 . . .</code></pre>
</div>
<div id="network-matrices" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Network matrices<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#network-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Quite naturally, if a network is undirected, its adjacency matrix will be symmetric. When a network is directed, it will not necessarily be so.
One tricky item to keep in mind: sometimes food webs can be represented not using an adjacency matrix, but rather using an “energy flux” matrix which represents interactions as an antisymmetric matrix of +1’s and -1’s.
Adjacency matrices can be binary or real-valued (if they represent interaction weights).
A source of confusion can be the difference between adjacency and incidence matrices.</p>
</div>
<div id="matrices-for-multipartite-networks" class="section level3 hasAnchor" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Matrices for multipartite networks<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#matrices-for-multipartite-networks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In bipartite networks, the diagonal blocks of the adjacency matrix are full of 0 only. It is thus more useful to only look at the (rectangle) non-zero off-diagonal blocks, which are called the incidence matrix in ecology (or bi-adjacency matrix in other disciplines).
The function as_biadjacency_matrix of igraph extracts this matrix from a bipartite network.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb42-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">sample_bipartite</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="st">&quot;gnm&quot;</span>,<span class="at">m=</span><span class="dv">8</span>)</span>
<span id="cb42-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb42-2" tabindex="-1"></a>net[,]</span></code></pre></div>
<pre><code>## 8 x 8 sparse Matrix of class &quot;dgCMatrix&quot;
##                     
## [1,] . . . . 1 . 1 .
## [2,] . . . . 1 . 1 .
## [3,] . . . . . 1 1 .
## [4,] . . . . 1 . 1 .
## [5,] 1 1 . 1 . . . .
## [6,] . . 1 . . . . .
## [7,] 1 1 1 1 . . . .
## [8,] . . . . . . . .</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb44-1" tabindex="-1"></a><span class="fu">as_biadjacency_matrix</span>(net)</span></code></pre></div>
<pre><code>##   5 6 7 8
## 1 1 0 1 0
## 2 1 0 1 0
## 3 0 1 1 0
## 4 1 0 1 0</code></pre>
</div>
<div id="degrees" class="section level3 hasAnchor" number="9.3.5">
<h3><span class="header-section-number">9.3.5</span> Degrees<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#degrees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A basic element of representation of networks is the degree of a node.
The degree of a node is the number of interactions it shares with other nodes.
For undirected networks, this definition is straightforward and corresponds to row- or column-sums of the binary adjacency matrix.
For directed networks, one actually needs to define the in-degree and out-degree of each node, which correspond respectively to the number of incoming and outgoing edges.
The function degree of igraph computes all of these using the argument called mode.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb46-1" tabindex="-1"></a><span class="fu">degree</span>(net)</span></code></pre></div>
<pre><code>## [1] 2 2 2 2 3 1 4 0</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb48-1" tabindex="-1"></a><span class="fu">degree</span>(net,<span class="at">mode=</span><span class="st">&quot;in&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 2 2 2 2 3 1 4 0</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb50-1" tabindex="-1"></a><span class="fu">degree</span>(net,<span class="at">mode=</span><span class="st">&quot;out&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 2 2 2 2 3 1 4 0</code></pre>
<p>The degree distribution corresponds to the realized empirical distribution of degrees in the network. It can be obtained using a variety of functions, including degree_distribution in igraph.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb52-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">degree</span>(net.mat),<span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(<span class="fu">degree</span>(net.mat)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb53-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">degree_distribution</span>(net.mat, <span class="at">cumulative =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="connectance" class="section level3 hasAnchor" number="9.3.6">
<h3><span class="header-section-number">9.3.6</span> Connectance<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#connectance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Connectance is an important notion. It is defined as the proportion of possible interactions that really exist. There are plenty of ways to implement its computation (e.g. using mean), but it is important to correct these according to the impossible interactions (e.g. correcting for self-links or edges within levels in bipartite networks).</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb54-1" tabindex="-1"></a>conn<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">as.matrix</span>(net.mat[,]))</span>
<span id="cb54-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb54-2" tabindex="-1"></a>conn</span></code></pre></div>
<pre><code>## [1] 0.02669989</code></pre>
</div>
</div>
<div id="crash-course-matrices-eigenvalues-jacobian-matrix" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Crash course: matrices, eigenvalues, Jacobian matrix<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#crash-course-matrices-eigenvalues-jacobian-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="crash-course-matrices" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Crash course: matrices<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#crash-course-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Matrices are mathematical objects that represent tables, i.e. have rows and columns. The element at row <span class="math inline">\(i\)</span> and column <span class="math inline">\(j\)</span> of matrix <span class="math inline">\(M\)</span> is often noted <span class="math inline">\(m_{ij}\)</span>.
Matrices and vectors follow a strange multiplication operation, noted with %<em>% in R (rather than </em> which encodes a more plastic multiplication operation).</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb56-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">9</span>,<span class="dv">1</span>,<span class="fl">0.5</span>),<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb56-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb56-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">3</span>)</span>
<span id="cb56-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb56-3" tabindex="-1"></a>m<span class="sc">*</span>x</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]
## [1,]  0.0000000  2.5209672  2.5209672
## [2,]  0.0000000 -0.8336708 -0.8336708
## [3,] -0.1836979  0.0000000  0.0000000</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb58-1" tabindex="-1"></a>m<span class="sc">%*%</span>x</span></code></pre></div>
<pre><code>##           [,1]
## [1,] -1.017369
## [2,] -1.017369
## [3,]  2.520967</code></pre>
</div>
<div id="crash-course-matrix-eigenvalues" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Crash course: matrix eigenvalues<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#crash-course-matrix-eigenvalues" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All matrices are associated with a set of values called “eigenvalues” which represent the “multiplicators” of the matrix. Each of these eigenvalues <span class="math inline">\(\lambda\)</span> is associated to eigenvectors <span class="math inline">\(x\)</span> such that multiplying <span class="math inline">\(x\)</span> by the matrix <span class="math inline">\(M\)</span> results in only multiplying <span class="math inline">\(x\)</span> by <span class="math inline">\(\lambda\)</span>:
<span class="math display">\[M.x = \lambda x\]</span></p>
<p>The collection of eigenvalues of <span class="math inline">\(M\)</span> is called its spectrum. The spectrum is always finite and has at most a number of distinct elements equal to the smallest dimension of <span class="math inline">\(M\)</span>.</p>
<p>The function eigen yields the eigensystem (eigenvalues and eigenvectors) of a matrix.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb60-1" tabindex="-1"></a><span class="fu">eigen</span>(m)</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1]  1.618034e+00 -6.180340e-01  1.422473e-16
## 
## $vectors
##            [,1]       [,2]          [,3]
## [1,] -0.6479362 -0.4653411  2.819061e-16
## [2,] -0.6479362 -0.4653411 -7.071068e-01
## [3,] -0.4004466  0.7529378  7.071068e-01</code></pre>
</div>
<div id="crash-course-jacobian-matrices" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> Crash course: Jacobian matrices<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#crash-course-jacobian-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A set of ordinary differential equations (ODEs), such as those given by Lotka-Volterra equations, can be written in compact form as:</p>
<p><span class="math display">\[\frac{d\overrightarrow{x}}{dt} = \overrightarrow{F}\left(\overrightarrow{x} \right)\]</span></p>
<p>Let us assume that there exists an equilibrium <span class="math inline">\(\overrightarrow{x}^*\)</span> for this system. If we want to assess whether this equilibrium is stable, we need to linearize the dynamics around the equilibrium:</p>
<p><span class="math display">\[\frac{d\left( \overrightarrow{x}-\overrightarrow{x}^*\right)}{dt} \approx J\left(\overrightarrow{x}^*\right).\left( \overrightarrow{x}-\overrightarrow{x}^*\right)\]</span></p>
<p>The matrix <span class="math inline">\(J\left(\overrightarrow{x}^*\right)\)</span> is called the Jacobian matrix of the dynamical system at the equilibirum <span class="math inline">\(\overrightarrow{x}^*\)</span>
The expression for eh Jacobian matrix is obtained using the partial derivatives of the different components of <span class="math inline">\(\overrightarrow{F}\)</span>:
<span class="math display">\[J\left(\overrightarrow{x}^*\right) = \left.\left(\partial F_i/\partial x_j\right)\right\rvert_{x=x^*}\]</span></p>
<p>Formal computations of Jacobian matrices can be done with R using the package calculus:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb62-1" tabindex="-1"></a><span class="co">#jacobian(c(&quot;r*n1*(1-n1/k)-a*n1*n2/(1+h*n1)&quot;,&quot;b*n1*n2/(1+h*n1)-d*n2&quot;), var = c(&quot;n1&quot;, &quot;n2&quot;))</span></span></code></pre></div>
</div>
</div>
<div id="theories-and-notable-results" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Theories and notable results<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#theories-and-notable-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="lotka-volterra-and-networks" class="section level3 hasAnchor" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Lotka-Volterra and networks<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#lotka-volterra-and-networks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the classic Lotka-Volterra system, given for a dimensionless system (i.e. the coefficient of self-feedback are all set to 1):
<span class="math display">\[\frac{dx_i}{dt} = x_i \left[ r_i - x_i + \sum_j a_{ij}x_j\right]\]</span>
This system of ODEs can be seen as describing the dynamics of a network of species, with matrix <span class="math inline">\(A\)</span> as its “weighted” adjacency matrix.</p>
</div>
<div id="mays-stability-result" class="section level3 hasAnchor" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> May’s stability result<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#mays-stability-result" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the 70’s, Sir Robert May published a very important mathematical ecology result which shook some of the beliefs ecologists had at that time.
The idea is to assume that a community consists of <span class="math inline">\(S\)</span> species and that species abundances of these species are fixed at an equilibrium value <span class="math inline">\(\overrightarrow{x}^*\)</span>. May’s approach asks the question: what should happen if elements of the Jacobian matrix were randomly drawn according to a simple distribution? More precisely, May assumed that diagonal elements of the Jacobian were equal (or similar) and negative, while the off-diagonal elements had a probability <span class="math inline">\(c\)</span> (the connectance) of being non-zero, and if not equal to zero, followed a normal distribution of mean 0 and standard deviation <span class="math inline">\(\sigma\)</span>.
The result of May thus stipulates that the equilibrium can only be stable when
<span class="math display">\[\begin{equation}
\sigma \sqrt{cS} &lt; -\overline{J_{ii}}
\end{equation}\]</span></p>
<p>This result can be explained geometrically (based on the circular law): for a random matrix with this particular distribution of off-diagonal elements, the distribution of eigenvalues will be enclosed in a disk of center <span class="math inline">\(\left(-\overline{J_{ii}},0\right)\)</span> and radius <span class="math inline">\(\sigma \sqrt{cS}\)</span> in the complex plane. For all eigenvalues to have negative real parts, the radius of this disk should be less than the distance between (0,0) and its center.</p>
<p><img src="fig06Networks/May.jpg" width="284" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb63-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>),<span class="at">nrow=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb63-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb63-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">eigen</span>(m)<span class="sc">$</span>values,<span class="at">asp=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" />
This result can be interpreted as follows: for a given equilibrium to be stable, it should have low diversity and/or low connectance and/or a low variability of non-diagonal Jacobian elements (i.e. feedbacks among species abundances) and/or highly negative diagonal Jacobian elements (i.e. strong negative feedbacks of species upon themselves).</p>
<p>Intuitively, this does not seem to conform to reality: we see species-rich systems in which species interact relatively strongly and not too sparsely, without intense self-regulation…
So, some of the assumptions must be false and we can look for changes to these assumptions:
- dynamics could be transient rather than at equilibrium
- interactions might be structured and not completely random (see Claire’s talk)</p>
</div>
<div id="feasibility-vs.-stability" class="section level3 hasAnchor" number="9.5.3">
<h3><span class="header-section-number">9.5.3</span> Feasibility vs. stability<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#feasibility-vs.-stability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One other strong argument contradicting May’s result is the following: in many cases, it might actually be more difficult to obtain an equilibrium including all species (i.e. have feasibility) than for this equilibrium to be stable.
For instance, Bizeul &amp; Najim proved that in a certain class of LV systems, feasibility is obtained only when
<span class="math display">\[\sigma \sqrt{2Slog(S)} &lt; -\overline{J_{ii}}\]</span>
where <span class="math inline">\(\sigma\)</span> is the standard deviation of the LV matrix (not the Jacobian matrix) and the connectance is merged into <span class="math inline">\(\sigma^2\)</span>.</p>
<p>In the simulation paper of L. Stone, similar results were obtained – here stability (on the left) is lost after feasibility (on the right) when increasing of a parameter (<span class="math inline">\(\gamma\)</span>) which is proportional to our <span class="math inline">\(\sigma\)</span>.</p>
<p><img src="fig06Networks/Stone.jpg" width="436" /></p>
</div>
<div id="food-web-invariants" class="section level3 hasAnchor" number="9.5.4">
<h3><span class="header-section-number">9.5.4</span> Food web invariants<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#food-web-invariants" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the 80-90’s, one important goal of interaction network research was to find invariant properties, i.e. statistics or metrics that did not vary among food webs. With this goal in mind, two models were proposed.
First, the cascade model of Cohen &amp; Briand proposed that predators only eat a rather fixed number of prey species. This corresponds to predators eating prey that are are smaller than them with probability <span class="math inline">\(c/S\)</span> (<span class="math inline">\(c\)</span> being a fixed parameter), so that connectance decreases as <span class="math inline">\(1/S\)</span>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb64-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">cascade_matrix</span>(<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb64-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb64-2" tabindex="-1"></a><span class="fu">sum</span>(m)<span class="sc">/</span>(<span class="fu">dim</span>(m)[<span class="dv">1</span>]<span class="sc">*</span>(<span class="fu">dim</span>(m)[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 0.2289474</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb66-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">cascade_matrix</span>(<span class="dv">10</span>,<span class="dv">200</span>)</span>
<span id="cb66-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb66-2" tabindex="-1"></a><span class="fu">sum</span>(m)<span class="sc">/</span>(<span class="fu">dim</span>(m)[<span class="dv">1</span>]<span class="sc">*</span>(<span class="fu">dim</span>(m)[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 0.02434673</code></pre>
<p>The second model that was developed to find invariants is the niche model of Williams and Martinez. In this model, all species are supposed to be defined by their size and to eat all species with size contained within an interval centred around a size lower than the predator’s.
With the right parameter values, one can use this model to generate a food web that has a given connectance, whatever the number of species in the food web.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb68-1" tabindex="-1"></a>niche<span class="ot">&lt;-</span><span class="fu">niche_matrix</span>(<span class="fl">0.2</span>,<span class="dv">100</span>)</span>
<span id="cb68-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb68-2" tabindex="-1"></a>m<span class="ot">&lt;-</span>niche<span class="sc">$</span>matrix</span>
<span id="cb68-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb68-3" tabindex="-1"></a><span class="fu">sum</span>(m)<span class="sc">/</span>(<span class="fu">dim</span>(m)[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.2288</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb70-1" tabindex="-1"></a>niche<span class="ot">&lt;-</span><span class="fu">niche_matrix</span>(<span class="fl">0.2</span>,<span class="dv">200</span>)</span>
<span id="cb70-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb70-2" tabindex="-1"></a>m<span class="ot">&lt;-</span>niche<span class="sc">$</span>matrix</span>
<span id="cb70-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb70-3" tabindex="-1"></a><span class="fu">sum</span>(m)<span class="sc">/</span>(<span class="fu">dim</span>(m)[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.195325</code></pre>
</div>
<div id="generating-the-niche-model" class="section level3 hasAnchor" number="9.5.5">
<h3><span class="header-section-number">9.5.5</span> Generating the niche model<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#generating-the-niche-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Exercise: generate 100 virtual food webs similar to the one described by mat</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb72-1" tabindex="-1"></a>niches<span class="ot">&lt;-</span><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="cf">function</span>(x) <span class="fu">niche_matrix</span>(conn,<span class="fu">dim</span>(mat)[<span class="dv">1</span>]))</span>
<span id="cb72-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb72-2" tabindex="-1"></a>ms<span class="ot">&lt;-</span><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="cf">function</span>(x) niches[[x]]<span class="sc">$</span>matrix)</span></code></pre></div>
</div>
<div id="robustness-to-secondary-extinctions" class="section level3 hasAnchor" number="9.5.6">
<h3><span class="header-section-number">9.5.6</span> Robustness to secondary extinctions<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#robustness-to-secondary-extinctions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The general idea is to assume that when a species is removed from a network, the species interacting with it could go extinct (secondary extinction).
Robustness analysis then consists in assessing how many species are lost when R species are removed.
The most used indicator of robustness is the R50 which is the percentage of species on needs to remove from a web to lose 50% of its species.</p>
<p><img src="fig06Networks/Dunne1.jpg" width="429" /></p>
<p>In the paper of J. Dunne and collaborators, they used examples based on a variety of datasets. The basic rule then is that a species go extinct when it loses all its prey items (except itself if it is cannibalistic).
One can obtain different scenarios based on how removed species are chosen (intentionality: how strongly the species’ degree changes its probability of being drawn randomly as the next one to be removed).</p>
<p><img src="fig06Networks/Dunne2.jpg" width="215" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb73-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">graph_from_adjacency_matrix</span>(m,<span class="at">mode=</span><span class="st">&quot;directed&quot;</span>)</span>
<span id="cb73-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb73-2" tabindex="-1"></a>i_index <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span><span class="fl">0.1</span>)</span>
<span id="cb73-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb73-3" tabindex="-1"></a>i_index <span class="ot">&lt;-</span> <span class="fu">head</span>(i_index,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb73-4"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb73-4" tabindex="-1"></a>prob_exp<span class="ot">&lt;-</span><span class="fu">exponent.removal</span>(net, i_index)</span>
<span id="cb73-5"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb73-5" tabindex="-1"></a><span class="fu">V</span>(net)<span class="sc">$</span>name<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb73-6"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb73-6" tabindex="-1"></a><span class="fu">iterate</span>(<span class="at">fw_to_attack=</span>net, prob_exp, <span class="at">alpha1=</span><span class="dv">50</span>, <span class="at">iter=</span><span class="dv">10</span>, i_index, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Iteration 1</code></pre>
<pre><code>## Iteration 2</code></pre>
<pre><code>## Iteration 3</code></pre>
<pre><code>## Iteration 4</code></pre>
<pre><code>## Iteration 5</code></pre>
<pre><code>## Iteration 6</code></pre>
<pre><code>## Iteration 7</code></pre>
<pre><code>## Iteration 8</code></pre>
<pre><code>## Iteration 9</code></pre>
<pre><code>## Iteration 10</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<pre><code>##    i_index  meanR         sdR lower.bound upper.bound
## 1      0.0 0.5045 0.001581139     0.50352     0.50548
## 2      0.1 0.5050 0.000000000     0.50500     0.50500
## 3      0.2 0.5050 0.000000000     0.50500     0.50500
## 4      0.3 0.5050 0.000000000     0.50500     0.50500
## 5      0.4 0.5050 0.000000000     0.50500     0.50500
## 6      0.5 0.5050 0.000000000     0.50500     0.50500
## 7      0.6 0.5050 0.000000000     0.50500     0.50500
## 8      0.7 0.5050 0.000000000     0.50500     0.50500
## 9      0.8 0.5050 0.000000000     0.50500     0.50500
## 10     0.9 0.5050 0.000000000     0.50500     0.50500</code></pre>
</div>
</div>
<div id="a-quick-primer-on-network-statistics" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> A quick primer on network statistics<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#a-quick-primer-on-network-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="degree-distributions" class="section level3 hasAnchor" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> Degree distributions<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#degree-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Basically, one can do three things with degree distributions:
- compute them empirically
- generate networks similar to one that is observed using its degree sequence
- compare the degree distribution to benchmark distributions of integers (Poisson, power law, …) or of degrees of well-known random networks (Erdos-Renyi, random geometric graph, Watts-Strogatz…)</p>
<p><img src="fig06Networks/Dunne3.jpg" width="336" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb85-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">graph_from_adjacency_matrix</span>(m)</span>
<span id="cb85-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb85-2" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">degree</span>(net),<span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(<span class="fu">degree</span>(net)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb86-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">degree_distribution</span>(net, <span class="at">cumulative =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb87-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">sample_degseq</span>(<span class="fu">degree</span>(net),<span class="at">method =</span> <span class="st">&quot;vl&quot;</span>)</span>
<span id="cb87-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb87-2" tabindex="-1"></a></span>
<span id="cb87-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb87-3" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">degree</span>(net))</span></code></pre></div>
<pre><code>## [1] 78.13</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb89-1" tabindex="-1"></a><span class="fu">ks.test</span>(<span class="fu">degree</span>(net),<span class="st">&quot;pbinom&quot;</span>,<span class="fu">length</span>(<span class="fu">V</span>(net)),<span class="fu">mean</span>(<span class="fu">degree</span>(net))<span class="sc">/</span><span class="fu">length</span>(<span class="fu">V</span>(net)))</span></code></pre></div>
<pre><code>## Warning in ks.test.default(degree(net), &quot;pbinom&quot;, length(V(net)),
## mean(degree(net))/length(V(net))): ties should not be present for the
## Kolmogorov-Smirnov test</code></pre>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  degree(net)
## D = 0.34515, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<p>Power laws are among the most popular distributions of degrees discussed in the literature. However, a question worth asking is whether power laws are useful in ecology, i.e. whether it is actually possible to ascertain power-lawed degrees in ecological networks.
As Stumpf &amp; Porter (2012) clearly articulated, this would require to have degrees ranging at the very least between 1 and 100 (2 orders of magnitude), which is quite unheard of.</p>
</div>
<div id="null-models-randomizations" class="section level3 hasAnchor" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> Null models / randomizations<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#null-models-randomizations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Statistics on networks are hard to test because everything depends on everything else in a network…</p>
<p>So to test for extraordinary patterns in a network (or between them), one can resort to two strategies:
- either to define a probabilistic model to build a null hypothesis (e.g. using the expected degree distribution)
- or to define a null model based on some randomization scheme</p>
<p>One of the most useful and simplest such scheme is the configuration model. Under this null model, edges are randomly reattached to other nodes such that all nodes keep their degrees. This behaves effectively as if all nodes were attached to half-edges which were randomly paired until the resulting network yields no self-link and no double link.</p>
<p><img src="fig06Networks/configuration.jpg" width="706" /></p>
<p>For bipartite binary networks, there is an algorithm (curveball) which yields the configuration model quickly and efficiently.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb92-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">sample_bipartite</span>(<span class="dv">50</span>,<span class="dv">50</span>,<span class="st">&quot;gnp&quot;</span>,<span class="fl">0.1</span>)</span>
<span id="cb92-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb92-2" tabindex="-1"></a>sample.bip.config<span class="ot">&lt;-</span><span class="fu">simulate</span>(<span class="fu">nullmodel</span>(<span class="fu">as_incidence_matrix</span>(net),<span class="st">&quot;curveball&quot;</span>),<span class="at">nsim=</span><span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## Warning: `as_incidence_matrix()` was deprecated in igraph 1.6.0.
## ℹ Please use `as_biadjacency_matrix()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb94-1" tabindex="-1"></a><span class="fu">dim</span>(sample.bip.config)</span></code></pre></div>
<pre><code>## [1]   50   50 1000</code></pre>
<p>For unipartite binary networks, the task is slightly harder, but doable using sample_degseq.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb96-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">200</span> <span class="co">#1000</span></span>
<span id="cb96-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb96-2" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">sample_gnp</span>(n,<span class="fl">0.2</span>, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb96-3" tabindex="-1"></a>sample.config.undirected<span class="ot">&lt;-</span><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="cf">function</span>(x) <span class="fu">sample_degseq</span>(<span class="fu">degree</span>(net), <span class="at">method =</span> <span class="st">&quot;vl&quot;</span>))</span>
<span id="cb96-4"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb96-4" tabindex="-1"></a><span class="fu">length</span>(sample.config.undirected)</span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>For directed networks, it is even worse because we have no indication that the random matrices are all explored and represented fairly among the realizations of the algorithm.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb98-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">sample_gnp</span>(n,<span class="fl">0.2</span>, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb98-2" tabindex="-1"></a>sample.config.directed<span class="ot">&lt;-</span><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="cf">function</span>(x) <span class="fu">sample_degseq</span>(<span class="fu">degree</span>(net,<span class="at">mode=</span><span class="st">&quot;out&quot;</span>), <span class="fu">degree</span>(net,<span class="at">mode=</span><span class="st">&quot;in&quot;</span>), <span class="at">method =</span> <span class="st">&quot;simple.no.multiple&quot;</span>))</span>
<span id="cb98-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb98-3" tabindex="-1"></a><span class="fu">length</span>(sample.config.directed)</span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>Finally, for any weighted network (bipartite or unipartite), the task is even more difficult.</p>
</div>
<div id="network-structure" class="section level3 hasAnchor" number="9.6.3">
<h3><span class="header-section-number">9.6.3</span> Network structure<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#network-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ecological interaction networks can have non-random structures. In ecology, we tend to focus on two such structures: modularity (on the left) and nestedness (on the right).</p>
<p><img src="fig06Networks/Lewinsohn.jpg" width="662" /></p>
<p>In the following we will more strongly focus on modularity than on nestedness, for reasons that will be explained later.</p>
</div>
<div id="modularity" class="section level3 hasAnchor" number="9.6.4">
<h3><span class="header-section-number">9.6.4</span> Modularity<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#modularity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Modularity, as defined by Newman, is given by the following formula:
<span class="math display">\[\begin{equation}
Q = \frac{1}{A} \sum_{i,j} \left[ a_{ij} - \frac{d_i d_j}{A}\right]\delta_{ij}
\end{equation}\]</span>
where <span class="math inline">\(A\)</span> is the total number of connections in the network (i.e. <span class="math inline">\(A = \sum_i \sum_j a_{ij}\)</span>), <span class="math inline">\(d_i\)</span> is the degree of species <span class="math inline">\(i\)</span> (i.e. <span class="math inline">\(d_i = \sum_j a_{ij}\)</span>) and the <span class="math inline">\(\delta_{ij}\)</span> are dummy variables indicating whether species/nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are assumed to belong to the same module/community/cluster.
In layman’s terms, modularity is a quantity that measures how ``intense’’ interactions are within modules, and thus by contrast how little interaction there is between nodes belonging to different modules.
The principle of modularity search is to look for the partitioning of nodes into communities/modules that maximizes the associated modularity score.
The problem of modularity search is quite complex (NP-complete problem) and thus can be solved with different algorithms that have their pros and cons.</p>
<p>Modularity, in its classic form, only works for undirected networks.
Three algorithms that are often used in ecology are the edge-betweenness algorithm (EB), the leading-eigenvector one (LE) and the Louvain algorithm (ML).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb100-1" tabindex="-1"></a>net<span class="ot">&lt;-</span><span class="fu">sample_gnp</span>(<span class="dv">100</span>,<span class="fl">0.2</span>, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb100-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb100-2" tabindex="-1"></a>EB.mod<span class="ot">&lt;-</span><span class="fu">cluster_edge_betweenness</span>(net)</span>
<span id="cb100-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb100-3" tabindex="-1"></a>LE.mod<span class="ot">&lt;-</span><span class="fu">cluster_leading_eigen</span>(net)</span>
<span id="cb100-4"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb100-4" tabindex="-1"></a>ML.mod<span class="ot">&lt;-</span><span class="fu">cluster_louvain</span>(net)</span>
<span id="cb100-5"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb100-5" tabindex="-1"></a></span>
<span id="cb100-6"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb100-6" tabindex="-1"></a><span class="fu">plot</span>(EB.mod,net,<span class="at">layout =</span> layout_with_mds)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb101-1" tabindex="-1"></a><span class="fu">plot</span>(LE.mod,net,<span class="at">layout =</span> layout_with_mds)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-2.png" width="672" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb102-1" tabindex="-1"></a><span class="fu">plot</span>(ML.mod,net,<span class="at">layout =</span> layout_with_mds)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-3.png" width="672" /></p>
<p>Again, modularity is not adapted to directed networks, but there ways to circumvent this issue:
- by making the network/adjacency matrix symmetric
- through the use of another definition of modularity (e.g. the infomap definition of Rosvall and Bergström)</p>
<div id="modularity-of-the-empirical-food-web" class="section level4 hasAnchor" number="9.6.4.1">
<h4><span class="header-section-number">9.6.4.1</span> Modularity of the empirical food web<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#modularity-of-the-empirical-food-web" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As mentioned before, it is highly recommended to check whether the obtained modularity is ``expected’’ or extraordinary using a null model. Here is an example using the empirical food web.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb103-1" tabindex="-1"></a>modul<span class="ot">&lt;-</span><span class="fu">cluster_louvain</span>(<span class="fu">graph_from_adjacency_matrix</span>(mat,<span class="at">mode=</span><span class="st">&quot;undirected&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: The `adjmatrix` argument of `graph_from_adjacency_matrix()` must be symmetric
## with mode = &quot;undirected&quot; as of igraph 1.6.0.
## ℹ Use mode = &quot;max&quot; to achieve the original behavior.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb105-1" tabindex="-1"></a>moduls<span class="ot">&lt;-</span><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="cf">function</span>(x) <span class="fu">cluster_louvain</span>(<span class="fu">graph_from_adjacency_matrix</span>(ms[[x]],<span class="at">mode=</span><span class="st">&quot;undirected&quot;</span>))<span class="sc">$</span>modularity)</span>
<span id="cb105-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb105-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">unlist</span>(moduls)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb106-1" tabindex="-1"></a>modul.ecdf<span class="ot">&lt;-</span><span class="fu">ecdf</span>(<span class="fu">unlist</span>(moduls))</span>
<span id="cb106-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb106-2" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">modul.ecdf</span>(modul<span class="sc">$</span>modularity[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="which-algorithm" class="section level4 hasAnchor" number="9.6.4.2">
<h4><span class="header-section-number">9.6.4.2</span> Which algorithm?<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#which-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Because there are tons of algorithms already developed to find clusters/communities/modules in networks, it is easy to get lost… Yet two papers (at least) have made our life easier by comparing all these algorithms, bot for unipartite networks (Yang et al. 2016) and bipartite networks (Leger et al. 2015).</p>
</div>
</div>
<div id="block-models" class="section level3 hasAnchor" number="9.6.5">
<h3><span class="header-section-number">9.6.5</span> Block models<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#block-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another possibility when looking for clusters of species that interact more among themselves is to look for blocks of nodes/species that ``behave’’ similarly. This can be achieved using stochastic block models (SBM), also sometimes called latent block models (LBM) when dealing with bipartite networks.</p>
<p>Block models work by optimizing the fit of a model (in the classic statistical sense) which assigns probability of membership to groups and probability of interaction between nodes of known groups.
Block models can be fitted on different kinds of adjacency matrices following different distributions (e.g. Bernoulli for binary adjacency matrices, Poisson for counts, etc.).
The inference of a block model yields one parameter per block (the ``expected connection’’ within the block) and the proportions of nodes belonging to each group.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb108-1" tabindex="-1"></a>sbmnet <span class="ot">&lt;-</span> <span class="fu">sampleSimpleSBM</span>(<span class="dv">100</span>, <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">25</span>, .<span class="dv">25</span>), <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">diag</span>(.<span class="dv">4</span>, <span class="dv">3</span>) <span class="sc">+</span> <span class="fl">0.05</span>), <span class="at">model =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb108-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb108-2" tabindex="-1"></a><span class="fu">head</span>(sbmnet<span class="sc">$</span>networkData)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
## [1,]   NA    1    0    0    0    0    0    0    0     0     1     0     0     0
## [2,]    1   NA    0    0    0    0    0    0    0     0     0     1     1     0
## [3,]    0    0   NA    0    0    0    0    0    0     0     0     0     0     1
## [4,]    0    0    0   NA    0    0    1    1    0     1     0     0     1     0
## [5,]    0    0    0    0   NA    0    0    0    0     1     0     1     0     0
## [6,]    0    0    0    0    0   NA    0    0    0     0     0     0     0     0
##      [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]
## [1,]     0     1     0     0     0     1     0     0     0     0     0     0
## [2,]     0     1     0     0     1     0     0     0     0     1     0     0
## [3,]     0     0     1     1     0     1     0     0     0     0     0     0
## [4,]     1     0     1     0     0     1     0     0     0     1     0     0
## [5,]     0     1     0     0     1     0     1     0     1     0     0     0
## [6,]     0     0     0     0     0     0     0     0     0     0     0     0
##      [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37] [,38]
## [1,]     0     0     0     0     0     0     0     0     0     0     0     0
## [2,]     0     0     0     1     0     1     0     0     0     0     1     0
## [3,]     0     0     1     0     0     0     1     0     0     0     0     0
## [4,]     0     0     0     0     0     0     1     0     0     0     0     0
## [5,]     0     1     0     1     0     0     0     0     0     0     1     1
## [6,]     0     0     0     0     1     0     0     0     0     0     0     0
##      [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49] [,50]
## [1,]     0     0     0     0     0     0     0     0     0     0     0     0
## [2,]     0     0     0     0     1     1     0     0     0     0     0     0
## [3,]     0     0     1     0     0     0     0     0     0     0     1     1
## [4,]     0     0     0     0     0     0     0     0     1     0     1     1
## [5,]     0     0     0     0     0     1     0     1     0     0     0     0
## [6,]     1     0     0     0     0     0     1     0     0     0     0     0
##      [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60] [,61] [,62]
## [1,]     0     0     0     0     0     0     0     0     0     0     0     1
## [2,]     0     1     0     0     0     1     0     0     0     0     0     0
## [3,]     0     1     0     1     0     0     0     1     0     0     0     0
## [4,]     0     0     1     1     0     0     0     0     1     0     0     1
## [5,]     0     0     0     0     0     0     0     0     0     0     0     0
## [6,]     1     0     0     0     0     0     0     0     0     0     0     0
##      [,63] [,64] [,65] [,66] [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74]
## [1,]     0     0     0     0     0     0     0     1     0     0     0     0
## [2,]     0     0     0     0     0     0     1     0     0     0     0     1
## [3,]     1     0     0     0     1     1     0     1     1     0     0     0
## [4,]     1     0     0     0     1     0     0     0     1     0     0     0
## [5,]     0     0     0     1     0     0     0     0     0     0     0     0
## [6,]     0     1     1     0     0     0     0     1     0     0     0     0
##      [,75] [,76] [,77] [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86]
## [1,]     0     0     0     1     0     0     0     0     0     0     0     0
## [2,]     0     0     0     0     0     0     0     0     0     0     0     0
## [3,]     0     0     0     0     0     1     0     0     0     1     1     0
## [4,]     1     0     0     0     0     1     0     0     0     0     1     1
## [5,]     0     0     0     0     0     0     0     0     1     0     0     0
## [6,]     0     0     0     0     0     0     1     0     0     0     0     0
##      [,87] [,88] [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98]
## [1,]     0     0     0     1     0     0     0     0     0     0     1     0
## [2,]     0     0     1     0     0     0     0     0     0     0     0     1
## [3,]     1     0     0     0     0     0     0     1     0     0     1     0
## [4,]     0     0     0     0     0     0     0     1     1     0     1     0
## [5,]     0     0     0     1     0     0     0     0     0     0     0     0
## [6,]     0     0     0     1     0     1     0     0     0     0     0     0
##      [,99] [,100]
## [1,]     0      0
## [2,]     0      0
## [3,]     0      1
## [4,]     0      1
## [5,]     0      0
## [6,]     0      0</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb110-1" tabindex="-1"></a>net.SBM <span class="ot">&lt;-</span> <span class="fu">estimateSimpleSBM</span>(<span class="fu">as.matrix</span>(sbmnet<span class="sc">$</span>networkData))</span></code></pre></div>
<pre><code>## -&gt; Estimation for 1 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<pre><code>## -&gt; Computation of eigen decomposition used for initalizations
## 
## -&gt; Pass 1
##     -&gt; With ascending number of groups
##         -&gt; For 2 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-35-2.png" width="672" /></p>
<pre><code>##         -&gt; For 3 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-35-3.png" width="672" /></p>
<pre><code>##         -&gt; For 4 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-35-4.png" width="672" /></p>
<pre><code>##         -&gt; For 5 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-35-5.png" width="672" /></p>
<pre><code>##     -&gt; With descending number of groups
##         -&gt; For 4 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-35-6.png" width="672" /></p>
<pre><code>##         -&gt; For 3 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-35-7.png" width="672" /></p>
<pre><code>##         -&gt; For 2 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-35-8.png" width="672" /></p>
<pre><code>## -&gt; Pass 2
##     -&gt; With ascending number of groups
##         -&gt; For 2 groups
##         -&gt; For 3 groups
##         -&gt; For 4 groups
##         -&gt; For 5 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-35-9.png" width="672" /></p>
<pre><code>##     -&gt; With descending number of groups
##         -&gt; For 4 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-35-10.png" width="672" /></p>
<pre><code>##         -&gt; For 3 groups
##         -&gt; For 2 groups
## -&gt; Pass 3
##     -&gt; With ascending number of groups
##         -&gt; For 2 groups
##         -&gt; For 3 groups
##         -&gt; For 4 groups
##         -&gt; For 5 groups
##     -&gt; With descending number of groups
##         -&gt; For 4 groups
##         -&gt; For 3 groups
##         -&gt; For 2 groups</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb122-1" tabindex="-1"></a><span class="fu">plot</span>(net.SBM, <span class="st">&#39;expected&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-11.png" width="672" /></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb123-1" tabindex="-1"></a><span class="fu">plot</span>(net.SBM, <span class="st">&#39;data&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-12.png" width="672" /></p>
</div>
<div id="modularity-and-blocks" class="section level3 hasAnchor" number="9.6.6">
<h3><span class="header-section-number">9.6.6</span> Modularity and blocks<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#modularity-and-blocks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is possible to compare the partitionings of nodes obtained through modularity search and SBMs, for instance comparing the result of Louvain algorithm with a simple SBM on the network given by mat.</p>
<p>The alluvial plot helps visualize the correspondence between these groups.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb124-1" tabindex="-1"></a>m.SBM <span class="ot">&lt;-</span> <span class="fu">estimateSimpleSBM</span>(mat)</span></code></pre></div>
<pre><code>## -&gt; Estimation for 1 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<pre><code>## -&gt; Computation of eigen decomposition used for initalizations
## 
## -&gt; Pass 1
##     -&gt; With ascending number of groups
##         -&gt; For 2 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<pre><code>##         -&gt; For 3 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-36-3.png" width="672" /></p>
<pre><code>##         -&gt; For 4 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-36-4.png" width="672" /></p>
<pre><code>##         -&gt; For 5 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-36-5.png" width="672" /></p>
<pre><code>##     -&gt; With descending number of groups
##         -&gt; For 4 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-36-6.png" width="672" /></p>
<pre><code>##         -&gt; For 3 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-36-7.png" width="672" /></p>
<pre><code>##         -&gt; For 2 groups
## </code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-36-8.png" width="672" /></p>
<pre><code>## -&gt; Pass 2
##     -&gt; With ascending number of groups
##         -&gt; For 2 groups
##         -&gt; For 3 groups
##         -&gt; For 4 groups
##         -&gt; For 5 groups
##     -&gt; With descending number of groups
##         -&gt; For 4 groups
##         -&gt; For 3 groups
##         -&gt; For 2 groups</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb134-1" tabindex="-1"></a>modul<span class="ot">&lt;-</span><span class="fu">cluster_louvain</span>(<span class="fu">graph_from_adjacency_matrix</span>(mat,<span class="at">mode=</span><span class="st">&quot;undirected&quot;</span>))</span>
<span id="cb134-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb134-2" tabindex="-1"></a><span class="fu">make_alluvial_2</span>(m.SBM<span class="sc">$</span>memberships,modul<span class="sc">$</span>membership,<span class="st">&quot;Blocks&quot;</span>,<span class="st">&quot;Modules&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-9.png" width="672" /></p>
<p>It is also possible to look at whether these groupings have anything to do with trophic level (sensus MacKay et al.).</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb135-1" tabindex="-1"></a><span class="fu">count_components</span>(net.mat)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb137-1" tabindex="-1"></a>net.comp<span class="ot">&lt;-</span><span class="fu">components</span>(net.mat)</span>
<span id="cb137-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb137-2" tabindex="-1"></a>tl<span class="fl">.1</span><span class="ot">&lt;-</span><span class="fu">trophic_levels</span>(<span class="fu">largest_component</span>(net.mat))</span>
<span id="cb137-3"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb137-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">largest_component</span>(net.mat),<span class="at">layout =</span> layout_as_food_web)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb138-1" tabindex="-1"></a><span class="fu">plot</span>(tl<span class="fl">.1</span><span class="sc">~</span><span class="fu">as.factor</span>(m.SBM<span class="sc">$</span>indMemberships[<span class="fu">which</span>(net.comp<span class="sc">$</span>membership<span class="sc">==</span><span class="dv">1</span>),]<span class="sc">%*%</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)),<span class="at">xlab=</span><span class="st">&quot;SBM group&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Trophic level&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-2.png" width="672" /></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb139-1" tabindex="-1"></a><span class="fu">plot</span>(tl<span class="fl">.1</span><span class="sc">~</span><span class="fu">as.factor</span>(modul<span class="sc">$</span>membership[<span class="fu">which</span>(net.comp<span class="sc">$</span>membership<span class="sc">==</span><span class="dv">1</span>)]),<span class="at">xlab=</span><span class="st">&quot;module&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Trophic level&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-3.png" width="672" /></p>
<p>As we can see, SBM-derived groups seem to be better at capturing trophic levels.</p>
</div>
<div id="spectral-clustering" class="section level3 hasAnchor" number="9.6.7">
<h3><span class="header-section-number">9.6.7</span> Spectral clustering<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#spectral-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One drawback of SBM is that they can be slow to converge, especially when the dataset is big. A convenient replacement algorithm when the number of groups to look for is known (or can be easily guessed) is spectral clustering.
The idea of spectral clustering is to make use of the Laplacian matrix <span class="math inline">\(L\)</span> of the graph, given by:
<span class="math display">\[L = D - A\]</span>
where <span class="math inline">\(D\)</span> is the diagonal matrix of nodes’ degrees and <span class="math inline">\(A\)</span> is the adjacency matrix.</p>
<p>The Laplacian matrix has interesting properties, the best of all being that the number of zeros among its eigenvalues yield the number of components of the graph (one 0 means there is a single connected component, two zeros means the network is split in two disconnected components, etc.). The eigenvectors associated the zero eigenvalues can inform on the membership of nodes to the different components.</p>
<p>The heuristics of the spectral clustering is to use the eigenvectors associated with the set of small non-zero eigenvalues of <span class="math inline">\(L\)</span> to deduce the ``almost components’’ of the graph. To do so, one chooses a number of no-zero eigenvalues to keep and then the algorithm uses the associated eigenvector to find the groups through a K-means algorithm on the space obtained with these eigenvectors.</p>
<p>Here is an example of spectral clustering on the previous block-model graph.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb140-1" tabindex="-1"></a>SC<span class="ot">&lt;-</span><span class="fu">spectral_clustering</span>(<span class="fu">graph_from_adjacency_matrix</span>(sbmnet<span class="sc">$</span>networkData),<span class="dv">3</span>)</span>
<span id="cb140-2"><a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#cb140-2" tabindex="-1"></a><span class="fu">plotMyMatrix</span>(sbmnet<span class="sc">$</span>networkData,<span class="at">clustering=</span><span class="fu">list</span>(<span class="st">&quot;row&quot;</span><span class="ot">=</span>SC,<span class="st">&quot;col&quot;</span><span class="ot">=</span>SC))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="nestedness" class="section level3 hasAnchor" number="9.6.8">
<h3><span class="header-section-number">9.6.8</span> Nestedness<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#nestedness" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The idea of nestedness is to measure the tendency for specialists to only interact with a subsample of the interactors of generalists. In other words, a network would be said ``non-nested’’ only when specialists would interact more likely with specialists than with generalists.</p>
<p>Several indices have been developed over the years. Navigating their complexity is the purpose of the synthesis written by Podani and Schmera (2012).</p>
<p>I will not delve too long on the topic of nestedness because recent research seem to indicate that the concept is not really fruitful for a variety of reasons:
- it seems to be very strongly linked to connectance
- the diversity of nestedness indices tend to obfuscate its meaning (results reported show more about the index than about the concept)
- these different indices can yield very different results when applied to the same dataset
- in the classic case of power law distributions of degrees, the nestedness scores tend to be completely detrmined by the exponent of the power law
- finally, when putting the common datasets in the right matrix ensemble (i.e. using correct null models to sample similar matrices), reported nestedness values seem to be completely expected.</p>
</div>
<div id="last-words" class="section level3 hasAnchor" number="9.6.9">
<h3><span class="header-section-number">9.6.9</span> Last words<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#last-words" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>ecological interaction networks can be used to study community or ecosystem properties</li>
<li>random network models can help gauge generalities and specificities of networks</li>
<li>all network patterns do not have a mechanistic model-based explanation yet, but some do (like the link between feasibility, stability, or robustness and connectance)</li>
<li>interaction network data of different types lend themselves to different analyses (e.g. modularity for binary networks, value adjacency matrix with signed interactions for May-like analyses)</li>
</ul>
</div>
</div>
<div id="literature" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Literature<a href="interaction-networks-food-webs-and-complexity-in-ecology-day-4.html#literature" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Astegiano, J., Guimarães Jr, P. R., Cheptou, P.-O., Vidal, M. M., Mandai, C. Y., Ashworth, L. &amp; Massol, F. (2015) Persistence of plants and pollinators in the face of habitat loss: Insights from trait-based metacommunity models. Advances in Ecological Research - vol. 53 (eds G. Woodward &amp; D. A. Bohan), pp. 201-257. Academic Press.</p>
<p>Bizeul, P. &amp; Najim, J. (2021) Positive solutions for large random linear systems. Proceedings of the American Mathematical Society, 149, 2333-2348.</p>
<p>Clauset, A., Shalizi, C. R. &amp; Newman, M. E. J. (2009) Power-law distributions in empirical data. SIAM Review, 51, 661-703.</p>
<p>Dunne, J. A., Williams, R. J. &amp; Martinez, N. D. (2002) Food-web structure and network theory: The role of connectance and size. Proceedings of the National Academy of Sciences, 99, 12917-12922.</p>
<p>Dunne, J. A., Williams, R. J. &amp; Martinez, N. D. (2002) Network structure and biodiversity loss in food webs: robustness increases with connectance. Ecology Letters, 5, 558-567.</p>
<p>James, A., Pitchford, J. W. &amp; Plank, M. J. (2012) Disentangling nestedness from models of ecological complexity. Nature, 487, 227-230.</p>
<p>Leger, J.-B., Daudin, J.-J. &amp; Vacher, C. (2015) Clustering methods differ in their ability to detect patterns in ecological networks. Methods in Ecology and Evolution, 6, 474-481.</p>
<p>Lewinsohn, T. M., Prado, P. I., Jordano, P., Bascompte, J. &amp; Olesen, J. M. (2006) Structure in plant-animal interaction assemblages. Oikos, 113, 174-184.</p>
<p>May, R. M. (1972) Will a large complex system be stable? Nature, 238, 413-414.</p>
<p>Newman, M. E. J. (2006) Modularity and community structure in networks. Proceedings of the National Academy of Sciences, 103, 8577-8582.</p>
<p>Pocock, M. J. O., Evans, D. M. &amp; Memmott, J. (2012) The robustness and restoration of a network of ecological networks. Science, 335, 973-977.</p>
<p>Payrató-Borràs, C., Hernández, L. &amp; Moreno, Y. (2019) Breaking the Spell of Nestedness: The Entropic Origin of Nestedness in Mutualistic Systems. Physical Review X, 9, 031024.</p>
<p>Podani, J. &amp; Schmera, D. (2012) A comparative evaluation of pairwise nestedness measures. Ecography, 35, 889-900.</p>
<p>Stone, L. (2016) The Google matrix controls the stability of structured ecological and biological networks. Nature Communications, 7, 12857.</p>
<p>Strona, G., Nappo, D., Boccacci, F., Fattorini, S. &amp; San-Miguel-Ayanz, J. (2014) A fast and unbiased procedure to randomize ecological binary matrices with fixed row and column totals. Nature Communications, 5.</p>
<p>Stumpf, M. P. H. &amp; Porter, M. A. (2012) Critical truths about power laws. Science, 335, 665-666.</p>
<p>Thomas, M., Verzelen, N., Barbillon, P., Coomes, O. T., Caillon, S., McKey, D., Elias, M., Garine, E., Raimond, C., Dounias, E., Jarvis, D., Wencélius, J., Leclerc, C., Labeyrie, V., Cuong, P. H., Hue, N. T. N., Sthapit, B., Rana, R. B., Barnaud, A., Violon, C., Arias Reyes, L. M., Latournerie Moreno, L., De Santis, P. &amp; Massol, F. (2015) A network-based method to detect patterns of local crop biodiversity: validation at the species and infra-species levels. Advances in Ecological Research, 53, 259-320.</p>
<p>Williams, R. J. &amp; Martinez, N. D. (2000) Simple rules yield complex food webs. Nature, 404, 180-183.</p>
<p>Yang, Z., Algesheimer, R. &amp; Tessone, C. J. (2016) A Comparative Analysis of Community Detection Algorithms on Artificial Networks. Scientific Reports, 6, 30750.</p>
<p>Yodzis, P. (1998) Local trophodynamics and the interaction of marine mammals and fisheries in the Benguela ecosystem. Journal of Animal Ecology, 67, 635-658.</p>

<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div class="csl-entry">
Xie, Yihui. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.org/knitr/">http://yihui.org/knitr/</a>.
</div>
<div class="csl-entry">
———. 2023. <em>Bookdown: Authoring Books and Technical Documents with r Markdown</em>. <a href="https://github.com/rstudio/bookdown">https://github.com/rstudio/bookdown</a>.
</div>
</div>
</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="spatial-data-day-3.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/06-Networks.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
